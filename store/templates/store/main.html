<!DOCTYPE html>
{% load static %}
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>{% block title %}{% endblock %}</title>
    <link rel="stylesheet" type = "text/css" href="{% static 'css/main.css' %}">
  </head>
  <body>

    <div class="header-navigation" id = "myTopnav">
      <a href="{% url 'store' %}">Store</a>
    <div class="cart-form">

      <a href="{% url 'cart' %}">Корзина</a>
      <div class="">
        Количестов товаров: {{ store.cartItems }}
      </div>
      <p id="cart-total">0</p>

    </div>
    </div>
      {% block content %}

      {% endblock %}
      <script type="text/javascript" src = "{% static 'js/cart.js' %}"></script>

      <script type="text/javascript">
        var user = '{{ request.user }}'

        function getToken(name){
          var cookieValue = null;
          if(document.cookie && document.cookie !== ''){
            var cookies = document.cookie.split(';');
            for (var i = 0; i < cookies.length; i++){
              var cookie = cookies[i].trim();
              if(cookie.substring(0, name.length + 1) === (name + '=')){
                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                break;
              }
            }
          }
          return cookieValue;
        }
        var csrftoken = getToken('csrftoken');

        function getCookie(name){
          var cookieArr = document.cookie.split(";");

          for(var i = 0; i < cookieArr.length; i++){
            var cookiePair = cookieArr[i].split("=");

            if(name == cookiePair[0].trim()){
              return decodeURIComponent(cookiePair[1]);
            }
          }
          return null;
        }

        var cart = JSON.parse(getCookie('cart'))
        if(cart == undefined){
          cart = {}
          console.log('Cart was created!')
          document.cookie = 'cart=' + JSON.stringify(cart) + ";domain=;path=/"

        }

        console.log('Cart:', cart)
      </script>
  </body>
</html>
